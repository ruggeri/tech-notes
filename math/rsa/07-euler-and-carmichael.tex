\section{Carmichael's Totient Functions}

\subsection{Euler's Totient Function Formula}

\begin{remark}
  We know that $\vphif{p} = p - 1$.
\end{remark}

\begin{remark}
  We know that

  \begin{nedqn}
    \vphif{p^k}
  \eqcol
    p^k - p^k/p
  \\
  \eqcol
    p^{k-1} \parens{p - 1}
  \end{nedqn}

  \noindent
  Why? Because a number is coprime to $p^k$ iff it does not contain $p$
  as a factor.
\end{remark}

\begin{remark}
  Next consider $\vphif{ab}$ for $a, b$ coprime.

  I claim $a, b$ generate the group $\Zmod{ab}$. Why? Just consider $a +
  b$. This is coprime to both $a, b$. Thus $a + b$ must have additive
  order $ab$ in $\Zmod{ab}$. So indeed $a + b$ generates $\Zmod{ab}$.

  Great. So consider all values of the form: $ak_a + bk_b$. $k_a, k_b$
  range over $0,\ldots, b-1$ and $0,\ldots, a-1$. It should be clear
  that there is a unique choice of $k_a, k_b$ for each element of
  $\Zmod{ab}$.

  Great. Now, consider any $k_a$ coprime to $b$. I claim that $ak_a +
  bk_b$ is coprime to $b$. Why? First note that $bk_b$ is just a
  multiple of $b$. So $\gcd\parens{ak_a + bk_b, b} = \gcd\parens{ak_a,
  b}$. But both $a, k_a$ are coprime with $b$ so this is one.

  If I also want to insure that $ak_a + bk_b$ is coprime to $a$, I must
  likewise choose $k_b$ coprime with $a$.

  This shows that there are $\vphif{b}$ choices for $k_a$, and
  $\vphif{a}$ choices for $k_b$. Thus there are $\vphif{a}\vphif{b}$
  choices for $k_a, k_b$ such that $ak_a + bk_b$ is a unit.
\end{remark}

\begin{remark}
  Here is an alternate, more group theoreticy proof. It amounts to the
  same thing.

  Consider $\Zmod{ab}$ ($a, b$ coprime). This is isomorphic to $\Zmod{a}
  \oplus \Zmod{b}$ by the Fundamental Theorem of Finite Abelian Groups.

  Take a \emph{pair} of multiplicative units $u_a, u_b$ in $\Zmod{a},
  \Zmod{b}$. We know this means there exist $k_a, k_b$ such that
  $u_a^{k_a} \equiv 1 \pmod{p}, u_b^{k_b} \equiv 1 \pmod{q}$.

  Note that the concept of ``multiplication'' is precisely repeated
  addition. So we can talk about multiplication (and exponentiation) on
  \emph{any} additive group. That is: multiplication and exponentiation
  are \emph{notational}.

  We know that $(u_a^{k_a}) \oplus (u_b^{k_b}) = 1 \oplus 1$, which is
  good. But that doesn't directly relate to repeated addition of $u_a
  \oplus u_b$. So consider $k = k_a k_b$. We now know that:

  \begin{nedqn}
    \parens{u_a \oplus u_b}^{k}
  \eqcol
    (u_a^{k_a k_b}) \oplus (u_b^{k_a k_b})
  \\
  \eqcol
    (1^{k_b}) \oplus (1^{k_a})
  \\
  \eqcol
    1 \oplus 1
  \end{nedqn}

  What element of $\Zmod{ab}$ corresponds to $1 \oplus 1$? It must be a
  generator of $\Zmod{ab}$. In fact, we might as well assume that $1$
  maps to $1 \oplus 1$.  Because any isomorphism that maps $x$ unit to
  $1 \oplus 1$ can be ``fixed'' by first multiplying everything by
  $\inv{x}$.

  Thus, we've shown that for $u$ corresponding to $u_a \oplus u_b$, $u^k
  = 1$. Thus $u$ is a unit.

  Since $\Zmod{a}, \Zmod{b}$ have $\vphif{a}, \vphif{b}$ multiplicative
  units respectively, there are at least $\vphif{a}\vphif{b}$
  multiplicative units of $\Zmod{ab}$. It's simple to finish things by
  showing that if $u$ in $\Zmod{ab}$ is a mulitpicative unit, the
  corresponding $u_a, u_b$ are multiplicative units of $\Zmod{a},
  \Zmod{b}$.

  The multiplicative units of $\Zmod{ab}$ are thus in bijection with
  pairs of multiplicative units of $\Zmod{a}, \Zmod{b}$. In fact, we
  have:

  \begin{nedqn}
    \Zmodx{ab}
  & \cong &
    \Zmodx{a} \otimes \Zmodx{b}
  \end{nedqn}

  Thus there are $\vphif{a}\vphif{b}$ units of $\Zmodx{ab}$.
\end{remark}

\begin{remark}
  Don't be fooled by the isomorphism into thinking that if $\Zmodx{a},
  \Zmodx{b}$ are cyclic, then this implies that $\Zmodx{a} \otimes
  \Zmodx{b}$ is cyclic! We've seen when characterizing finite abelian
  groups that this is not necessarily true!

  We know that this is only true when $|\Zmodx{a}|, |\Zmodx{b}|$ are
  coprime!
\end{remark}

\begin{theorem}
  Since we can break any $n$ into a prime power factorization, we know
  that:

  \begin{nedqn}
    \vphif{\prod p_i^{k_i}}
  \eqcol
    \prod p_i^{k_i-1} \parens{p_i - 1}
  \end{nedqn}
\end{theorem}

\subsection{Carmichael's Totient Function}

\begin{definition}
  \define{Carmichael's totient function} $\lambda(n)$ maps $n$ to the
  smallest number such that $x^{\lambda(n)} = 1 \pmod{n}$ for all units
  $x \in \Zmodnx$.
\end{definition}

\begin{theorem}
  \begin{nedqn}
    \lambdaf{\prod p_i^{k_i}}
  \eqcol
    \lcm\parens{\lambdaf{p_1^{k_1}}, \ldots}
  \end{nedqn}
\end{theorem}

\begin{proof}
  First recall that $\Zmodn$ is isomorphic to $\bigoplus
  \Zmod{p_i^{k_i}}$. WLOG, assume that $1$ corresponds to $1
  \oplus \cdots \oplus 1$.

  Next, note that properties about exponentiation are really properties
  about repeated multiplication. And properties of multiplication are
  really just properties of repeated addition.

  So when you talk about $|u|$, you're really asking how long this
  sequence is:

  \begin{nedqn}
    &u&
  \\
    &u + u&
  \\
    &(u + u) + (u + u)&
  \\
    &\ldots&
  \\
    &1&
  \end{nedqn}

  \noindent
  How long is that sequence? Well, it exactly the length of the
  corresponding sequence:

  \begin{nedqn}
    & (u_1 \oplus \cdots \oplus u_n)&
  \\
    &(u_1 \oplus \cdots \oplus u_n) + (u_1 \oplus \cdots \oplus u_n)&
  \\
    &\ldots&
  \\
    &(1 \oplus \cdots \oplus 1)&
  \end{nedqn}

  \noindent
  But we know this! It is:

  \begin{nedqn}
    \lcm\parens{
      \lambdaf{p_1^{k_1}},
      \ldots,
      \lambdaf{p_n^{k_n}}
    }
  \end{nedqn}

  \noindent
  Thus we are done!
\end{proof}

\begin{remark}
  More succinctly: we've previously proven that for any coprime $a, b$,
  $\Zmodx{ab} \cong \Zmodx{a} \otimes \Zmodx{b}$. Take any $u \in
  \Zmodx{ab}$ and corresponding $u_a, u_b$ in $\Zmodx{a}, \Zmodx{b}$.

  Clearly $|u|$ must divide $|u_a||u_b|$. In fact, clearly $|u|$ is
  equal to $\lcm{|u_a|, |u_b|}$.

  So $\lambdaf{ab} = \lcmf{\lambdaf{a}, \lambdaf{b}}$.
\end{remark}

\begin{remark}
  We now must examine $\lambdaf{p^k}$.
\end{remark}

\begin{remark}
  When $\vphif{n}$ is prime, $\Zmodnx$ is a finite abelian group of
  prime order. That means that it is cyclic. That means that it is
  generated by some $x$ with $|x| = \vphif{n}$. So when $\vphif{n}$ is
  prime, $\lambda(n) = \vphif{n}$.
\end{remark}

\begin{remark}
  Next, consider when $\vphif{n}$ factors into $\prod p_i$. We can
  again split $\Zmodnx$ into a direct product of cyclic groups, each of
  size $p_i$. That is: $\Zmodnx \cong \bigotimes_i \Zmod{p_i}$.

  Take generators $g_i$ in each subgroup. Multiply these all together to
  get $g = \prod g_i$. It should be clear that $g$ generates $\Zmodnx$.
  It thus has order $\vphif{n}$.

  So again we have $\lambda(n) = \vphif{n}$.
\end{remark}

\begin{remark}
  We may consider what happens when $\vphif{n} = \prod p_i^{k_i}$. Note
  that we can again break this into a direct product of subgroups $A_i$
  of size $p_i^{k_i}$.

  Here is where things are different! We \emph{do not know} whether a
  subgroup $A_i$ is isomorphic to $\Zmod{p_i^{k_i}}$. If this is indeed
  true for each $A_i$ we would again have $\lambda(n) = \vphif{n}$.

  But we \emph{could} have, for instance, $A_i$ is a direct product of
  $k_i$ copies of $\Zmod{p_i}$. In this case, $A_i$ is \emph{acyclic}.
  More to the point, for all $a \in A_i$, $a^{|p_i|} = a$.

  In summary: the question of whether $\lambda(n) = \vphif{n}$ comes
  down to whether every subgroup of $\Zmodnx$ is cyclic. Equivalently:
  it comes down to whether $\Zmodnx$ is itself cyclic. Equivalently: it
  comes down to whether $\Zmodnx$ contains a \emph{primitive root}.
\end{remark}

\begin{definition}
  An element $g$ is a \define{root} of $1$ if $g^n = 1$ for some $n$. In
  a finite group, every element is a root of 1.

  An element $g$ is a \define{primitive root} of $1$ if it has order
  $|G|$. A group has a primitive root of unity iff it is cyclic.
\end{definition}

\begin{proposition}
  Because $\Zmodnx$ into a direct product of $\Zmod{p_i^{k_i}}$, we
  have:

  \begin{nedqn}
    \lambdaf{\prod p_i^{k_i}}
  \eqcol
    \lcm\parens{
      \lambdaf{p_1^{k_1}},
      \ldots
      \lambdaf{p_n^{k_n}}
    }
  \end{nedqn}
\end{proposition}

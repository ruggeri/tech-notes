\section{The Variance of $\snormal$}

The \define{variance} for a variable $X$ is defined as the squared
expected difference from the variable's mean. It is the ``squared
error'' you would get if you used $\mu$ as a constant predictor value
for samples from $X$.

Here is the formula for a variable $X$ with distribution defined by
density function $f$:

\begin{nedqn}
  \Var{X}
& \defeq &
  \expectation{
    \parens{
      X - \expectation{X}
    }^2
  }
\\
& = &
  \int_\reals f(x) (x - \mu)^2 \dx
\end{nedqn}

It is typical to denote the variance $\var$. Its square root, $\sigma$,
is called the \define{standard deviation}.

Let's prove that the parameter $\var$ is indeed the variance of
$\nnormal$. I will once again replace with $x \mapsto \parens{\sigma y +
\mu}$:

\begin{nedqn}
  \Var{\nnormal}
& = &
  \int_\reals
    \parens{x - \mu}^2
    \snormaleq
    \dx
  \\
& = &
  \sigma
  \int_\reals
    \parens{
      (\sigma y  + \mu) - \mu
    }^2
    %
    \nnormalc
    \normalexpf{
      \parens{
        \parens{\sigma y + \mu}
        -
        \mu
      }^2
    }{2\sigma^2}
    \dy
  \\
& = &
  \sigma^2
  \snormalc
  \int_\reals
    y^2
    \snormalexp[y]
    \dy
\end{nedqn}


Notice again the factor of $\sigma$ that entered our life (before
getting canceled). Now we have $\sigma^2$ times the variance of
$\snormal$. That makes a lot of sense! So now we only need to show that
the unit normal has variance one!

Let's do a further change of variables: $y \mapsto \sqrt{2} z$:

\begin{nedqn}
  \Var{\nnormal}
& = &
  \sigma^2
  \snormalc
  \int_\reals
    y^2
    \snormalexp[y]
    \dy
  \\
& = &
  \sigma^2
  \snormalc
  \sqrttwo
  \int_\reals
    \parens{\sqrttwo z}^2
    \normalexpf{
      \parens{\sqrt{2} z}^2
    }{2}
    \dz
  \\
& = &
  \sigma^2
  \frac{2}{\sqrtpi}
  \int_\reals
    z^2
    \gaussianexp[z]
    \dz
\end{nedqn}

Notice again the factor of $\sqrttwo$ that was added because $\dy =
\sqrttwo\dz$. To proceed, let's drop the constants to focus, and use
integration by parts.

\begin{nedqn}
  \fderivx \Bigl[
    z \gaussianexp[z]
  \Bigr]
& = &
  \gaussianexp[z]
  -
  2z^2
  \gaussianexp[z]
  \\
  %
\shortintertext{which implies that:}
  %
  2
  \int_\reals
    z^2
    \gaussianexp[z]
    \dz
& = &
  \int_\reals
    \gaussianexp[z]
    \dz
  -
  \Bparens{
    z \gaussianexp[z]
  }
  \intevalbar{-\infty}{\infty}
  \\
& = &
  \int_\reals
    \gaussianexp[z]
    \dz
  -
  \bparens{0 - 0}
  %
  \nedcomment{asymptotics}
  \\
& = &
  \sqrtpi
  %
  \nedcomment{Gaussian integral}
  \\
\shortintertext{in conclusion:}
  %
\IEEEeqnarraymulticol{3}{c}{
  \int_\reals
    z^2
    \gaussianexp[z]
    \dz
=
  \frac{\sqrtpi}{2}
}
  \\
\end{nedqn}

We can now plug this back in:

\begin{nedqn}
  \Var{\nnormal}
& = &
  \sigma^2
  \frac{2}{\sqrtpi}
  \int_\reals
    z^2
    \gaussianexp[z]
    \dy
  \\
& = &
  \sigma^2
  \frac{2}{\sqrtpi}
  \frac{\sqrtpi}{2}
  \\
& = &
  \sigma^2
\end{nedqn}

Done again!
